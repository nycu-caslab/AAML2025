
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab 4 : Elementwise Unit &#8212; CSIC30066: Accelerator Architectures for Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'labs/lab_4';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 5 : Systolic Array with im2col for Convolution" href="lab_5.html" />
    <link rel="prev" title="Lab 3 : Systolic Array" href="lab_3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">CSIC30066: Accelerator Architectures for Machine Learning</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Class:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../class/staff.html">Staff</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lab_1.html">Lab 1 : Environment Setup and Profiling a Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_2.html">Lab 2 : Quantization and SIMD MAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_3.html">Lab 3 : Systolic Array</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 4 : Elementwise Unit</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_5.html">Lab 5 : Systolic Array with im2col for Convolution</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../project/final_project.html">Final Project: MLPerfâ„¢ Tiny</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/labs/lab_4.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 4 : Elementwise Unit</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goal-of-this-lab">Goal of this lab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#porting-and-profiling-the-models-10">Porting and Profiling the Models - 10%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#porting-the-new-model-and-tests-5">Porting the New Model and Tests - 5%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#profiling-the-mobilevit-5">Profiling the MobileViT - 5%</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accelerating-the-logistic-function-60">Accelerating the Logistic Function - 60%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation-criteria">Evaluation Criteria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#guide">Guide</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#software">Software</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hardware">Hardware</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accelerating-the-softmax-function-20">Accelerating the Softmax Function - 20%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Evaluation Criteria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Guide</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-in-the-demo-10">Questions in the Demo - 10%</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submission">Submission</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="lab-4-elementwise-unit">
<h1>Lab 4 : Elementwise Unit<a class="headerlink" href="#lab-4-elementwise-unit" title="Link to this heading">#</a></h1>
<section id="goal-of-this-lab">
<h2>Goal of this lab<a class="headerlink" href="#goal-of-this-lab" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<ul class="simple">
<li><p><a class="reference internal" href="#porting-and-profiling-the-models-10"><span class="xref myst">Porting and Profiling the Models - 10%</span></a></p></li>
<li><p><a class="reference internal" href="#accelerating-the-logistic-function-60"><span class="xref myst">Accelerating the Logistic Function - 60%</span></a></p></li>
<li><p><a class="reference internal" href="#accelerating-the-softmax-function-20"><span class="xref myst">Accelerating the Softmax Function - 20%</span></a></p></li>
<li><p><a class="reference internal" href="#questions-in-the-demo-10"><span class="xref myst">Questions in the Demo - 10%</span></a></p></li>
</ul>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Modern models frequently utilize specialized activation functions that involve complex mathematical computations, such as exponentials, square roots, and reciprocals. Unlike simpler functions like ReLU, these sophisticated operations can become bottlenecks during model inference. In this lab, we will design an element-wise unit specifically for enhancing the inference speed of the <strong>Logistic</strong> and <strong>Softmax</strong> functions in the <strong>MobileViT</strong> model.</p>
</section>
<section id="porting-and-profiling-the-models-10">
<h2>Porting and Profiling the Models - 10%<a class="headerlink" href="#porting-and-profiling-the-models-10" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<section id="porting-the-new-model-and-tests-5">
<h3>Porting the New Model and Tests - 5%<a class="headerlink" href="#porting-the-new-model-and-tests-5" title="Link to this heading">#</a></h3>
<p>In this lab, we provide you a new model and the project template. Follow the instrusctions below to install them.</p>
<ol class="arabic">
<li><p>Project Template with Tests</p>
<p>The project template contains some tests and files youâ€™ll use in this lab.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">CFU_ROOT</span><span class="si">}</span>/proj/
$<span class="w"> </span>wget<span class="w"> </span>https://github.com/nycu-caslab/AAML2024/raw/main/lab4_util/lab4_template.zip
$<span class="w"> </span>unzip<span class="w"> </span>lab4_template.zip
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">/src/tensorflow/lite/micro/</span></code> directory, youâ€™ll find tests for the Logistic and Softmax functions, along with some updated kernels for MobileViT inference. <strong>DO NOT MODIFY</strong> any files in this directory.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 10/18,23:25: </span>Updated the template to include modified kernels.</p>
</div>
</li>
<li><p>MobileViT Model</p>
<p>This is the model we aim to accelerate. We will use this model to benchmark the performance of your design.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">CFU_ROOT</span><span class="si">}</span>/common/src/models
$<span class="w"> </span>wget<span class="w"> </span>https://github.com/nycu-caslab/AAML2024/raw/main/lab4_util/lab4_model.zip
$<span class="w"> </span>unzip<span class="w"> </span>lab4_model.zip
</pre></div>
</div>
</li>
</ol>
<p>After that, just like we did in lab 1, we should modify some files to add the new models:</p>
<p><code class="docutils literal notranslate"><span class="pre">CFU-Playground/common/src/models/models.c</span></code></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;models/ds_cnn_stream_fe/ds_cnn.h&quot;</span>
<span class="c1">// add codes below</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;models/mobileViT_xxs/mobileViT.h&quot;</span>

<span class="p">...</span>

<span class="cp">#if defined(INCLUDE_MODEL_DS_CNN_STREAM_FE)</span>
<span class="w">        </span><span class="n">MENU_ITEM</span><span class="p">(</span><span class="n">AUTO_INC_CHAR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Ds cnn stream fe&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ds_cnn_stream_fe_menu</span><span class="p">),</span>
<span class="cp">#endif</span>
<span class="c1">// add codes below</span>
<span class="cp">#if defined(INCLUDE_MODEL_MOBILE_VIT_XXS)</span>
<span class="w">        </span><span class="n">MENU_ITEM</span><span class="p">(</span><span class="n">AUTO_INC_CHAR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MobileViT xxs&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mobileViT_xxs_menu</span><span class="p">),</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">CFU-Playground/common/src/tflite.cc</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef INCLUDE_MODEL_DS_CNN_STREAM_FE</span>
<span class="w">    </span><span class="mi">2048</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="c1">// add codes below</span>
<span class="cp">#ifdef INCLUDE_MODEL_MOBILE_VIT_XXS</span>
<span class="w">    </span><span class="mi">16384</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">CFU-Playground/proj/&lt;lab4</span> <span class="pre">proj</span> <span class="pre">folder&gt;/Makefile</span></code><br />
(This has been done in the project template.)</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">DEFINES</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span>INCLUDE_MODEL_MOBILE_VIT_XXS
</pre></div>
</div>
<p>After completing these steps, you should be able to run the MobileViT model and the Tests in the <code class="docutils literal notranslate"><span class="pre">Project</span> <span class="pre">menu</span></code>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>make<span class="w"> </span>prog<span class="w"> </span><span class="nv">EXTRA_LITEX_ARGS</span><span class="o">=</span><span class="s2">&quot;--cpu-variant=perf+cfu&quot;</span>
$<span class="w"> </span>make<span class="w"> </span>load
</pre></div>
</div>
<ul class="simple">
<li><p>MobileViT result of zeros input without any modification</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">Counter</span> <span class="o">|</span>  <span class="n">Total</span> <span class="o">|</span> <span class="n">Starts</span> <span class="o">|</span> <span class="n">Average</span> <span class="o">|</span>     <span class="n">Raw</span>
<span class="o">---------+--------+--------+---------+--------------</span>
    <span class="mi">0</span>    <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>   <span class="n">n</span><span class="o">/</span><span class="n">a</span>   <span class="o">|</span>            <span class="mi">0</span>
    <span class="mi">1</span>    <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>   <span class="n">n</span><span class="o">/</span><span class="n">a</span>   <span class="o">|</span>            <span class="mi">0</span>
    <span class="mi">2</span>    <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>   <span class="n">n</span><span class="o">/</span><span class="n">a</span>   <span class="o">|</span>            <span class="mi">0</span>
    <span class="mi">3</span>    <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>   <span class="n">n</span><span class="o">/</span><span class="n">a</span>   <span class="o">|</span>            <span class="mi">0</span>
    <span class="mi">4</span>    <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>   <span class="n">n</span><span class="o">/</span><span class="n">a</span>   <span class="o">|</span>            <span class="mi">0</span>
    <span class="mi">5</span>    <span class="o">|</span>   <span class="mi">145</span><span class="n">M</span> <span class="o">|</span>     <span class="mi">9</span>  <span class="o">|</span>    <span class="mi">16</span><span class="n">M</span>  <span class="o">|</span>    <span class="mi">145244066</span>
    <span class="mi">6</span>    <span class="o">|</span>  <span class="mi">1318</span><span class="n">M</span> <span class="o">|</span>    <span class="mi">37</span>  <span class="o">|</span>    <span class="mi">36</span><span class="n">M</span>  <span class="o">|</span>   <span class="mi">1317968736</span>
    <span class="mi">7</span>    <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>     <span class="mi">0</span>  <span class="o">|</span>   <span class="n">n</span><span class="o">/</span><span class="n">a</span>   <span class="o">|</span>            <span class="mi">0</span>
  <span class="mi">5234</span><span class="n">M</span> <span class="p">(</span>   <span class="mi">5233667340</span> <span class="p">)</span>  <span class="n">cycles</span> <span class="n">total</span>
<span class="mi">0</span> <span class="p">:</span> <span class="o">-</span><span class="mi">128</span><span class="p">,</span>
<span class="mi">1</span> <span class="p">:</span> <span class="mi">67</span><span class="p">,</span>
<span class="mi">2</span> <span class="p">:</span> <span class="mi">57</span><span class="p">,</span>
<span class="mi">3</span> <span class="p">:</span> <span class="o">-</span><span class="mi">72</span><span class="p">,</span>
<span class="mi">4</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
<span class="mi">5</span> <span class="p">:</span> <span class="mi">37</span><span class="p">,</span>
<span class="mi">6</span> <span class="p">:</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span>
<span class="mi">7</span> <span class="p">:</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span>
<span class="mi">8</span> <span class="p">:</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span>
<span class="mi">9</span> <span class="p">:</span> <span class="o">-</span><span class="mi">21</span><span class="p">,</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Tests for Logistic and Softmax</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CFU</span> <span class="n">Playground</span>
<span class="o">==============</span>
 <span class="mi">1</span><span class="p">:</span> <span class="n">TfLM</span> <span class="n">Models</span> <span class="n">menu</span>
 <span class="mi">2</span><span class="p">:</span> <span class="n">Functional</span> <span class="n">CFU</span> <span class="n">Tests</span>
<span class="o">&gt;</span><span class="mi">3</span><span class="p">:</span> <span class="n">Project</span> <span class="n">menu</span>
 <span class="mi">4</span><span class="p">:</span> <span class="n">Performance</span> <span class="n">Counter</span> <span class="n">Tests</span>
 <span class="mi">5</span><span class="p">:</span> <span class="n">TFLite</span> <span class="n">Unit</span> <span class="n">Tests</span>
 <span class="mi">6</span><span class="p">:</span> <span class="n">Benchmarks</span>
 <span class="mi">7</span><span class="p">:</span> <span class="n">Util</span> <span class="n">Tests</span>
 <span class="mi">8</span><span class="p">:</span> <span class="n">Embench</span> <span class="n">IoT</span>
 <span class="n">d</span><span class="p">:</span> <span class="n">Donut</span> <span class="n">demo</span>
<span class="n">main</span><span class="o">&gt;</span> <span class="mi">3</span>

<span class="n">Running</span> <span class="n">Project</span> <span class="n">menu</span>

<span class="n">Project</span> <span class="n">Menu</span>
<span class="o">============</span>
 <span class="mi">1</span><span class="p">:</span> <span class="n">Run</span> <span class="n">logistic</span> <span class="n">tests</span>
 <span class="mi">2</span><span class="p">:</span> <span class="n">Run</span> <span class="n">softmax</span> <span class="n">tests</span>
 <span class="n">x</span><span class="p">:</span> <span class="n">eXit</span> <span class="n">to</span> <span class="n">previous</span> <span class="n">menu</span>
<span class="n">project</span><span class="o">&gt;</span> <span class="mi">1</span>

<span class="n">Running</span> <span class="n">Run</span> <span class="n">logistic</span> <span class="n">tests</span>

<span class="n">LOGISTIC</span> <span class="n">TEST</span><span class="p">:</span>
<span class="n">Testing</span> <span class="n">LogisticQuantizedInt8AroundZeroShouldMatchGolden</span>
<span class="n">Testing</span> <span class="n">LogisticQuantizedInt8NarrowRangeShouldMatchGolden</span>
<span class="n">Testing</span> <span class="n">LogisticQuantizedInt8BasicShouldMatchGolden</span>
<span class="n">Testing</span> <span class="n">LogisticQuantizedInt8WideRangeShouldMatchGolden</span>
<span class="mi">4</span><span class="o">/</span><span class="mi">4</span> <span class="n">tests</span> <span class="n">passed</span>
<span class="o">~~~</span><span class="n">ALL</span> <span class="n">TESTS</span> <span class="n">PASSED</span><span class="o">~~~</span>
</pre></div>
</div>
</section>
<section id="profiling-the-mobilevit-5">
<h3>Profiling the MobileViT - 5%<a class="headerlink" href="#profiling-the-mobilevit-5" title="Link to this heading">#</a></h3>
<p>After executing the MobileViT model, you may notice that the inference process is quite slow. Please <strong>analyze and compare the time consumed by each operation</strong>, with particular attention to the <strong>activation functions</strong>. You may present your analysis in any format, such as <strong>a table or a pie chart</strong>. Additionally, you have the option to use data with or without SIMD MAC acceleration.</p>
<p>Here is an example of a pie chart:<br />
<a class="reference internal" href="../_images/pie_example.png"><img alt="../_images/pie_example.png" src="../_images/pie_example.png" style="width: 600px;" /></a></p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can use either the perf counter or the ticks displayed in the results after execution as your data source.
the displayed ticks look something like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>...
450,LOGISTIC,1848
451,MUL,84
452,CONCATENATION,35
453,CONV_2D,27022
454,LOGISTIC,1804
455,MUL,84
456,CONV_2D,9782
457,LOGISTIC,7071
458,MUL,333
459,AVERAGE_POOL_2D,84
460,RESHAPE,6
461,FULLY_CONNECTED,48
Perf counters not enabled.
  5558M (   5558234259 )  cycles total
</pre></div>
</div>
</div>
<p>Next, trace the code of the Logistic function to identify the <strong>complex mathematical computations involved</strong>, which may be contributing to the slow execution.</p>
<p>Make sure to present your findings to the TAs during the demo.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can start tracing the code from this file, and the model will use the topmost overloaded <code class="docutils literal notranslate"><span class="pre">Logistic(...)</span></code> function:<br />
<code class="docutils literal notranslate"><span class="pre">CFU-Playground/third_party/tflite-micro/tensorflow/lite/kernels/internal/reference/integer_ops/logistic.h</span></code><br />
Then, you will find the mathematical computations are defined in:<br />
<code class="docutils literal notranslate"><span class="pre">CFU-Playground/third_party/tflite-micro/third_party/gemmlowp/fixedpoint/fixedpoint.h</span></code></p>
</div>
</section>
</section>
<section id="accelerating-the-logistic-function-60">
<h2>Accelerating the Logistic Function - 60%<a class="headerlink" href="#accelerating-the-logistic-function-60" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<div class="amsmath math notranslate nohighlight">
\[\begin{gather*}
\text{logistic}(x) = \frac{1}{1 + e^{-x}}
\end{gather*}\]</div>
<p>(We have done these for you in the template.)<br />
Add the integer version of the Logistic function to your project.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>../../third_party/tflite-micro/tensorflow/lite/kernels/internal/reference/integer_ops/logistic.h<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>src/tensorflow/lite/kernels/internal/reference/integer_ops/logistic.h
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Add the <strong>sixth perf counter</strong> at the beginning and end of the <strong>topmost</strong> Logistic function within the <code class="docutils literal notranslate"><span class="pre">logistic.h</span></code> file in your project. This step is crucial for evaluating your score, so please ensure it is not overlooked.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">Logistic</span><span class="p">(</span><span class="kt">int32_t</span><span class="w"> </span><span class="n">input_zero_point</span><span class="p">,</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">input_range_radius</span><span class="p">,</span>
<span class="w">                     </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">input_multiplier</span><span class="p">,</span><span class="w"> </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">input_left_shift</span><span class="p">,</span>
<span class="w">                     </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">input_size</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int8_t</span><span class="o">*</span><span class="w"> </span><span class="n">input_data</span><span class="p">,</span>
<span class="w">                     </span><span class="kt">int8_t</span><span class="o">*</span><span class="w"> </span><span class="n">output_data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">perf_enable_counter</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>

<span class="w">  </span><span class="p">...</span>

<span class="w">  </span><span class="n">perf_disable_counter</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<section id="evaluation-criteria">
<h3>Evaluation Criteria<a class="headerlink" href="#evaluation-criteria" title="Link to this heading">#</a></h3>
<p>You should first pass the <code class="docutils literal notranslate"><span class="pre">LOGISTIC</span> <span class="pre">TEST</span></code> in the <code class="docutils literal notranslate"><span class="pre">Project</span> <span class="pre">menu</span></code>, then run MobileViT with any input and obtain scores based on the criteria.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Cycles of Counter 6</p></th>
<th class="head"><p>&gt; 1000M</p></th>
<th class="head"><p>400~1000M</p></th>
<th class="head text-left"><p>140~400M</p></th>
<th class="head text-left"><p>&lt; 140M</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Score</p></td>
<td><p>0</p></td>
<td><p>10</p></td>
<td class="text-left"><p>30</p></td>
<td class="text-left"><p>60</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You may need to accelerate both the exponential and reciprocal parts in order to meet the full score cycle count criteria.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>You will get <strong>0%</strong> if you canâ€™t pass all <code class="docutils literal notranslate"><span class="pre">LOGISTIC</span> <span class="pre">TEST</span></code> in the <code class="docutils literal notranslate"><span class="pre">Project</span> <span class="pre">menu</span></code>.</p>
</div>
</section>
<section id="guide">
<h3>Guide<a class="headerlink" href="#guide" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>You are not required to follow to the provided guide below</strong>. Instead, feel free to use any method to accelerate the inference of Logistic function, provided that it passes the unit test.</p>
</div>
<p>First of all, it is essential to familiarize yourself with <strong>fixed-point</strong> arithmetic and the <code class="docutils literal notranslate"><span class="pre">FixedPoint</span></code> class defined in <code class="docutils literal notranslate"><span class="pre">fixedpoint.h</span></code>. The key components and functions you are likely to use within the <code class="docutils literal notranslate"><span class="pre">FixedPoint</span></code> class include <code class="docutils literal notranslate"><span class="pre">kIntegerBits</span></code>, <code class="docutils literal notranslate"><span class="pre">FromRaw()</span></code>, and <code class="docutils literal notranslate"><span class="pre">raw()</span></code>.</p>
<p>Additionally, You can refer to <a class="reference external" href="https://en.wikipedia.org/wiki/Q_(number_format)">Wikipedia - Q format notation</a> and the comments for the <code class="docutils literal notranslate"><span class="pre">FixedPoint</span></code> class in <code class="docutils literal notranslate"><span class="pre">fixedpoint.h</span></code> to help you understand fixed-point arithmetic. <strong>The <a class="reference external" href="https://chummersone.github.io/qformat.html#converter">Q format converter</a> is also a very useful tool</strong> that you can use to convert between fixed-point and floating-point numbers, which will definitely assist you in debugging.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Part 2: the FixedPoint class.</span>

<span class="c1">// A FixedPoint object represents a fixed-point value stored in the underlying</span>
<span class="c1">// integer type tRawType, if tRawType is a plain scalar integer type.</span>
<span class="c1">// Alternatively, tRawType may be a SIMD type (e.g. NEON int32x4_t) in which</span>
<span class="c1">// case a FixedPoint object represents a corresponding SIMD vector of fixed</span>
<span class="c1">// point values.</span>
<span class="c1">//</span>
<span class="c1">// tIntegerBits describes the range of the fixed-point format: if</span>
<span class="c1">// tIntegerBits == m then the range of representable values is the half-open</span>
<span class="c1">// interval [-2^m; 2^m) where the open boundary on the right side means that</span>
<span class="c1">// 2^m is not representable (how close the maximum representable value is to</span>
<span class="c1">// it, depends on bit-depth of tRawType).</span>
<span class="c1">//</span>
<span class="c1">// In &quot;Q format notation&quot;,</span>
<span class="c1">//   https://en.wikipedia.org/wiki/Q_(number_format)</span>
<span class="c1">// we are describing the format</span>
<span class="c1">//   Qm.n</span>
<span class="c1">// where</span>
<span class="c1">//   m = tIntegerBits</span>
<span class="c1">// and</span>
<span class="c1">//   n = NumberOfBits(tRawType) - (m + 1)</span>
<span class="c1">// Note that the (m + 1) in the above line is because we adopt the convention</span>
<span class="c1">// that we count the integer bits exclusively of the sign bit; so (m + 1) is</span>
<span class="c1">// the total number of integer bits inclusive of the sign bit.</span>
<span class="c1">//</span>
<span class="c1">// Accordingly, the number of integral representable values in our range</span>
<span class="c1">//   [-2^m ; 2^m)</span>
<span class="c1">// is equal to 2^(m+1).</span>
</pre></div>
</div>
<p>After tracing the code, you may notice that the <strong>exponential</strong> and the <strong>reciprocal</strong> are the primary bottlenecks, so we can focus on accelerating these two operations in this function.<br />
<code class="docutils literal notranslate"><span class="pre">third_party/gemmlowp/fixedpoint/fixedpoint.h</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Returns logistic(x) = 1 / (1 + exp(-x)) for x &gt; 0.</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">tRawType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">tIntegerBits</span><span class="o">&gt;</span>
<span class="n">FixedPoint</span><span class="o">&lt;</span><span class="n">tRawType</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">&gt;</span><span class="w"> </span><span class="n">logistic_on_positive_values</span><span class="p">(</span>
<span class="w">    </span><span class="n">FixedPoint</span><span class="o">&lt;</span><span class="n">tRawType</span><span class="p">,</span><span class="w"> </span><span class="n">tIntegerBits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">one_over_one_plus_x_for_x_in_0_1</span><span class="p">(</span><span class="n">exp_on_negative_values</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="software">
<h4>Software<a class="headerlink" href="#software" title="Link to this heading">#</a></h4>
<p>Below is an example of replacing the original software-computed exponential with the CFU operation:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">tRawType</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">tIntegerBits</span><span class="o">&gt;</span>
<span class="n">FixedPoint</span><span class="o">&lt;</span><span class="n">tRawType</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exp_on_negative_values</span><span class="p">(</span>
<span class="w">    </span><span class="n">FixedPoint</span><span class="o">&lt;</span><span class="n">tRawType</span><span class="p">,</span><span class="w"> </span><span class="n">tIntegerBits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">typedef</span><span class="w"> </span><span class="n">FixedPoint</span><span class="o">&lt;</span><span class="n">tRawType</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ResultF</span><span class="p">;</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cfu_op0</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is just a simple example. You should properly design your CFU op to pass the data needed for the hardware unit. Also, you should properly handle the conversion of <code class="docutils literal notranslate"><span class="pre">FixedPoint</span></code> and the <code class="docutils literal notranslate"><span class="pre">tRawType</span></code> using <code class="docutils literal notranslate"><span class="pre">FromRaw()</span></code> and <code class="docutils literal notranslate"><span class="pre">raw()</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Given the symmetry of the Logistic function, itâ€™s only necessary to consider either positive or negative inputs for the exponential computation, with the negative ones being simpler to manage.</p>
</div>
</section>
<section id="hardware">
<h4>Hardware<a class="headerlink" href="#hardware" title="Link to this heading">#</a></h4>
<p>For the hardware unit section, itâ€™s important to first familiarize yourself with the <strong>val/rdy interface</strong> of the CFU. In Lab 2, the calculation required only a single cycle, making it straightforward to handle. However, in this lab, your CFU operations may take more than one cycle to complete. To better understand how to manage multi-cycle operations, refer to this article for examples and guidance.</p>
<blockquote>
<div><p><a class="reference external" href="https://cfu-playground.readthedocs.io/en/latest/interface.html">Details and Use Cases of the CPU &lt;-&gt; CFU interface</a></p>
</div></blockquote>
<p>For calculating results using hardware, you have the option to employ either a Lookup Table or Mathematical Approximation methods, such as the Taylor Series, Newton-Raphson division, or Polynomial Approximation.</p>
<p>In this lab, for the <strong>exponential function, we recommend using either a Lookup Table or the Taylor Series</strong>. For the <strong>reciprocal function, we suggest using a Lookup Table or the Newton-Raphson division method</strong>, similar to the approach used in <code class="docutils literal notranslate"><span class="pre">one_over_one_plus_x_for_x_in_0_1()</span></code>, but implemented in hardware.</p>
</section>
</section>
</section>
<section id="accelerating-the-softmax-function-20">
<h2>Accelerating the Softmax Function - 20%<a class="headerlink" href="#accelerating-the-softmax-function-20" title="Link to this heading">#</a></h2>
<div class="amsmath math notranslate nohighlight">
\[\begin{gather*}
\text{softmax}(x_i) = \frac{e^{x_{i}}}{\sum_{j=1}^n e^{x_{j}}}
\end{gather*}\]</div>
<p>Add the Softmax function to your project.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>../../third_party/tflite-micro/tensorflow/lite/kernels/internal/reference/softmax.h<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>src/tensorflow/lite/kernels/internal/reference/softmax.h
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Add the <strong>fifth perf counter</strong> at the beginning and end of the <strong>second</strong> Softmax function within the <code class="docutils literal notranslate"><span class="pre">softmax.h</span></code> file in your project. This step is crucial for evaluating your score, so please ensure it is not overlooked.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Quantized softmax with int8_t/uint8_t input and int8_t/uint8_t/int16_t</span>
<span class="c1">// output.</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">InputT</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">OutputT</span><span class="o">&gt;</span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">Softmax</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">SoftmaxParams</span><span class="o">&amp;</span><span class="w"> </span><span class="n">params</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">RuntimeShape</span><span class="o">&amp;</span><span class="w"> </span><span class="n">input_shape</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">InputT</span><span class="o">*</span><span class="w"> </span><span class="n">input_data</span><span class="p">,</span>
<span class="w">                    </span><span class="k">const</span><span class="w"> </span><span class="n">RuntimeShape</span><span class="o">&amp;</span><span class="w"> </span><span class="n">output_shape</span><span class="p">,</span><span class="w"> </span><span class="n">OutputT</span><span class="o">*</span><span class="w"> </span><span class="n">output_data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">perf_enable_counter</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="w">  </span>
<span class="w">  </span><span class="p">...</span>

<span class="w">  </span><span class="n">perf_disable_counter</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<section id="id1">
<h3>Evaluation Criteria<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>You should first pass the <code class="docutils literal notranslate"><span class="pre">SOFTMAX</span> <span class="pre">TEST</span></code> in the <code class="docutils literal notranslate"><span class="pre">Project</span> <span class="pre">menu</span></code>, then run MobileViT with any input and obtain scores based on the criteria.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Cycles of Counter 5</p></th>
<th class="head"><p>&gt; 60M</p></th>
<th class="head text-left"><p>30~60M</p></th>
<th class="head text-left"><p>&lt; 30M</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Score</p></td>
<td><p>0</p></td>
<td class="text-left"><p>10</p></td>
<td class="text-left"><p>20</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>You will get <strong>0%</strong> if you canâ€™t pass all <code class="docutils literal notranslate"><span class="pre">SOFTMAX</span> <span class="pre">TEST</span></code> in the <code class="docutils literal notranslate"><span class="pre">Project</span> <span class="pre">menu</span></code>.</p>
</div>
</section>
<section id="id2">
<h3>Guide<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Following the previous approach, replacing the exponential and reciprocal functions with CFU operations is a good idea. The CFU operations designed for the Logistic function might work here too.</p>
<p>But, be careful: the fixed-point integer bits used for the exponential function are different in the Logistic and Softmax functionsâ€”<strong>the Logistic uses 4 and the Softmax uses 5</strong>. Pay close attention to this detail.</p>
</section>
</section>
<section id="questions-in-the-demo-10">
<h2>Questions in the Demo - 10%<a class="headerlink" href="#questions-in-the-demo-10" title="Link to this heading">#</a></h2>
<p>You will be asked several questions about the concepts covered in this lab and your implementation. This section accounts for 10% of the total lab score.</p>
</section>
<section id="submission">
<h2>Submission<a class="headerlink" href="#submission" title="Link to this heading">#</a></h2>
<p>You need to hand in your <strong>CFU-Playground project folder</strong> without the <code class="docutils literal notranslate"><span class="pre">build</span></code> folder and renamed with your student ID.</p>
<p>Please organize your submission files into a zip archive structured as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>YourID.zip
    â””â”€â”€ YourID/
        â”œâ”€â”€ src/
        â”‚    â”œâ”€â”€ folder... 
        â”‚    â””â”€â”€ files...
        â”œâ”€â”€ cfu.v
        â””â”€â”€ Makefile
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>TAs should be able to run your project without any modification. If TAs cannot compile or run your code, <strong>you wonâ€™t receive any points, even if you passed the DEMO</strong>. Also, <strong>PLAGIARISM is not allowed</strong>.</p>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lab_3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 3 : Systolic Array</p>
      </div>
    </a>
    <a class="right-next"
       href="lab_5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 5 : Systolic Array with im2col for Convolution</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goal-of-this-lab">Goal of this lab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#porting-and-profiling-the-models-10">Porting and Profiling the Models - 10%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#porting-the-new-model-and-tests-5">Porting the New Model and Tests - 5%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#profiling-the-mobilevit-5">Profiling the MobileViT - 5%</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accelerating-the-logistic-function-60">Accelerating the Logistic Function - 60%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation-criteria">Evaluation Criteria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#guide">Guide</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#software">Software</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hardware">Hardware</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accelerating-the-softmax-function-20">Accelerating the Softmax Function - 20%</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Evaluation Criteria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Guide</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-in-the-demo-10">Questions in the Demo - 10%</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submission">Submission</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By  NYCU CAS-Lab
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024, NYCU CAS-Lab.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>